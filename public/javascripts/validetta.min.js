!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.XXX=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(){!function($){"use strict";var Validetta={},FIELDS={},RRULE=new RegExp(/^(minChecked|maxChecked|minSelected|maxSelected|minLength|maxLength|equalTo|different|regExp|remote|callback)\[(\w{1,15})\]/i),RMAIL=new RegExp(/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/),RNUMBER=new RegExp(/^[\-\+]?(\d+|\d+\.?\d+)$/),RTEL=new RegExp(/^[0-9?|\-]+$/),messages={required:"必須項目",email:"正しいメールアドレスを入力してください",tel:"正しい形式で入力してください",number:"英数字で入力してください",maxLength:"Maximum {count} characters allowed!",minLength:"Minimum {count} characters allowed!",maxChecked:"Maximum {count} options allowed. Please be sure to check.",minChecked:"Please select minimum {count} options.",maxSelected:"Maximum {count} selection allowed. Please be sure to check.",minSelected:"Minimum {count} selection allowed. Please be sure to check.",notEqual:"一致しません",different:"Fields cannot be the same as each other",creditCard:"Invalid credit card number. Please be sure to check."},defaults={showErrorMessages:!0,display:"bubble",errorTemplateClass:"validetta-bubble",errorClass:"validetta-error",validClass:"validetta-valid",bubblePosition:"bottom",bubbleGapLeft:15,bubbleGapTop:0,realTime:!1,onValid:function(){},onError:function(){},validators:{}},trim=function(value){return"string"==typeof value?value.replace(/^\s+|\s+$/g,""):value},Validator={required:function(tmp,self){switch(tmp.el.type){case"checkbox":return tmp.el.checked||messages.required;case"radio":return this.radio.call(self,tmp.el)||messages.required;case"select-multiple":return null!==tmp.val||messages.required;default:return""!==tmp.val||messages.required}},email:function(tmp){return RMAIL.test(tmp.val)||messages.email},number:function(tmp){return RNUMBER.test(tmp.val)||messages.number},tel:function(tmp){return RTEL.test(tmp.val)||messages.tel},minLength:function(tmp){var _length=tmp.val.length;return 0===_length||_length>=tmp.arg||messages.minLength.replace("{count}",tmp.arg)},maxLength:function(tmp){return tmp.val.length<=tmp.arg||messages.maxLength.replace("{count}",tmp.arg)},equalTo:function(tmp,self){return self.form.querySelector('input[name="'+tmp.arg+'"]').value===tmp.val||messages.notEqual},different:function(tmp,self){return self.form.querySelector('input[name="'+tmp.arg+'"]').value!==tmp.val||messages.different},creditCard:function(tmp){if(""===tmp.val)return!0;var reg,cardNumber,pos,digit,i,sub_total,strlen,sum=0;if(reg=new RegExp(/[^0-9]+/g),cardNumber=tmp.val.replace(reg,""),strlen=cardNumber.length,16>strlen)return messages.creditCard;for(i=0;strlen>i;i++)pos=strlen-i,digit=parseInt(cardNumber.substring(pos-1,pos),10),i%2===1?(sub_total=2*digit,sub_total>9&&(sub_total=1+(sub_total-10))):sub_total=digit,sum+=sub_total;return sum>0&&sum%10===0?!0:messages.creditCard},maxChecked:function(tmp,self){var cont=$(self.form.querySelectorAll('input[type=checkbox][name="'+tmp.el.name+'"]'));if(0===cont.index(tmp.el)){var count=cont.filter(":checked").length;if(0!==count)return count<=tmp.arg||messages.maxChecked.replace("{count}",tmp.arg)}},minChecked:function(tmp,self){var cont=$(self.form.querySelectorAll('input[type=checkbox][name="'+tmp.el.name+'"]'));if(0===cont.index(tmp.el)){var count=cont.filter(":checked").length;return count>=tmp.arg||messages.minChecked.replace("{count}",tmp.arg)}},maxSelected:function(tmp){return null!==tmp.val?tmp.val.length<=tmp.arg||messages.maxSelected.replace("{count}",tmp.arg):void 0},minSelected:function(tmp){return null!==tmp.val&&tmp.val.length>=tmp.arg||messages.minSelected.replace("{count}",tmp.arg)},radio:function(el){var count=this.form.querySelectorAll('input[type=radio][name="'+el.name+'"]:checked').length;return 1===count},regExp:function(tmp,self){var _arg=self.options.validators.regExp[tmp.arg],_reg=new RegExp(_arg.pattern);return _reg.test(tmp.val)||_arg.errorMessage},remote:function(tmp){tmp.remote=tmp.arg},callback:function(tmp,self){var _cb=self.options.validators.callback[tmp.arg];return _cb.callback(tmp.el,tmp.val)||_cb.errorMessage}};Validetta=function(form,options){this.handler=!1,this.options=$.extend(!0,{},defaults,options),this.form=form,this.xhr={},this.events()},Validetta.prototype={constructor:Validetta,events:function(){var self=this;$(this.form).submit(function(e){return FIELDS=this.querySelectorAll("[data-validetta]"),self.init(e)}),this.options.realTime===!0&&($(this.form).find("[data-validetta]").not("[type=checkbox]").on("change",function(e){return FIELDS=$(this),self.init(e)}),$(this.form).find("[data-validetta][type=checkbox]").on("click",function(e){return FIELDS=self.form.querySelectorAll('[data-validetta][type=checkbox][name="'+this.name+'"]'),self.init(e)})),$(this.form).on("reset",function(){return $(self.form.querySelectorAll("."+self.options.errorClass+", ."+self.options.validClass)).removeClass(self.options.errorClass+" "+self.options.validClass),self.reset()})},init:function(e){return this.reset(FIELDS),this.checkFields(e),"submit"!==e.type?void 0:"pending"===this.handler?!1:this.handler===!0?(this.options.onError.call(this,e),!1):this.options.onValid.call(this,e)},checkFields:function(e){var self=this,invalidFields=[];this.getInvalidFields=function(){return invalidFields};for(var i=0,_lengthFields=FIELDS.length;_lengthFields>i;i++)if(!FIELDS[i].disabled){var state,el=FIELDS[i],errors="",val=trim($(el).val()),methods=el.getAttribute("data-validetta").split(",");this.tmp={},this.tmp={el:el,val:val,parent:this.parents(el)};for(var j=0,_lengthMethods=methods.length;_lengthMethods>j;j++){var method,rule=methods[j].match(RRULE);if(null!==rule?("undefined"!=typeof rule[2]&&(this.tmp.arg=rule[2]),method=rule[1]):method=methods[j],(""!==val||"required"===method||"equalTo"===method)&&Validator.hasOwnProperty(method)&&(state=Validator[method](self.tmp,self),"undefined"!=typeof state&&state!==!0)){var _dataMsg=el.getAttribute("data-vd-message-"+method);null!==_dataMsg&&(state=_dataMsg),errors+=state+"<br/>"}}""!==errors?(invalidFields.push({field:el,errors:errors}),this.addErrorClass(this.tmp.parent),this.window.open.call(this,el,errors)):"undefined"!=typeof this.tmp.remote?this.checkRemote(el,e):("undefined"!=typeof state?this.addValidClass(this.tmp.parent):$(this.tmp.parent).removeClass(this.options.errorClass+" "+this.options.validClass),state=void 0)}},checkRemote:function(el,e){var ajaxOptions={},data={},fieldName=el.name||el.id;"undefined"==typeof this.remoteCache&&(this.remoteCache={}),data[fieldName]=this.tmp.val,ajaxOptions=$.extend(!0,{},{data:data},this.options.validators.remote[this.tmp.remote]||{});var cacheKey=$.param(ajaxOptions),cache=this.remoteCache[cacheKey];if("undefined"!=typeof cache)switch(cache.state){case"pending":this.handler="pending",cache.event=e.type;break;case"rejected":throw e.preventDefault(),new Error(cache.result.message);case"resolved":cache.result.valid===!1?(this.addErrorClass(this.tmp.parent),this.window.open.call(this,el,cache.result.message)):this.addValidClass(this.tmp.parent)}else{var _xhr=this.xhr[fieldName];"undefined"!=typeof _xhr&&"pending"===_xhr.state()&&_xhr.abort(),cache=this.remoteCache[cacheKey]={state:"pending",event:e.type},this.remoteRequest(ajaxOptions,cache,el,fieldName)}},remoteRequest:function(ajaxOptions,cache,el,fieldName){var self=this;$(this.tmp.parent).addClass("validetta-pending"),this.xhr[fieldName]=$.ajax(ajaxOptions).done(function(result){"object"!=typeof result&&(result=JSON.parse(result)),cache.state="resolved",cache.result=result,"submit"===cache.event?(self.handler=!1,$(self.form).trigger("submit")):result.valid===!1?(self.addErrorClass(self.tmp.parent),self.window.open.call(self,el,result.message)):self.addValidClass(self.tmp.parent)}).fail(function(jqXHR,textStatus){if("abort"!==textStatus){var _msg="Ajax request failed for field ("+fieldName+") : "+jqXHR.status+" "+jqXHR.statusText;throw cache.state="rejected",cache.result={valid:!1,message:_msg},new Error(_msg)}}).always(function(){$(self.tmp.parent).removeClass("validetta-pending")}),this.handler="pending"},window:{open:function(el,error){if(!this.options.showErrorMessages)return void(this.handler=!0);var elParent=this.parents(el);if("undefined"==typeof elParent&&(elParent=el[0].parentNode),!elParent.querySelectorAll("."+this.options.errorTemplateClass).length){var errorObject=document.createElement("span");if(errorObject.className=this.options.errorTemplateClass+" "+this.options.errorTemplateClass+"--"+this.options.bubblePosition,"bubble"===this.options.display){var pos,W=0,H=0;pos=$(el).position(),"bottom"===this.options.bubblePosition?H=el.offsetHeight:W=el.offsetWidth,errorObject.innerHTML="",errorObject.style.top=pos.top+H+this.options.bubbleGapTop+"px",errorObject.style.left=pos.left+W+this.options.bubbleGapLeft+"px"}elParent.appendChild(errorObject),errorObject.innerHTML=error,this.handler=!0}},close:function(el){el.parentNode.removeChild(el)}},reset:function(el){var _errorMessages={};_errorMessages="undefined"==typeof el||el.length>1&&"checkbox"!==el[0].type?this.form.querySelectorAll("."+this.options.errorTemplateClass):this.parents(el[0]).querySelectorAll("."+this.options.errorTemplateClass);for(var i=0,_lengthErrorMessages=_errorMessages.length;_lengthErrorMessages>i;i++)this.window.close.call(this,_errorMessages[i]);this.handler=!1},addErrorClass:function(el){$(el).removeClass(this.options.validClass).addClass(this.options.errorClass)},addValidClass:function(el){$(el).removeClass(this.options.errorClass).addClass(this.options.validClass)},parents:function(el){for(var upLength=parseInt(el.getAttribute("data-vd-parent-up"),10)||0,i=0;upLength>=i;i++)el=el.parentNode;return el}},$.fn.validetta=function(options,_messages){return $.validettaLanguage&&(messages=$.extend(!0,{},messages,$.validettaLanguage.messages)),"undefined"!=typeof _messages&&(messages=$.extend(!0,{},messages,_messages)),this.each(function(){new Validetta(this,options)})}}(jQuery)},{}]},{},[1])(1)});